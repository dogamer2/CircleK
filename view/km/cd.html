<h1>Access Code Admin</h1>
<div id="codes"></div>

<button id="new">Generate New Code</button>

<script type="module">
import { generateCode } from "../../supabase.js";
import { supabase } from "../../supabase.js";

async function loadCodes() {
  const { data } = await supabase.from("access_codes").select("*");
  document.getElementById("codes").innerHTML =
    data.map(c => `<div>${c.code} â€” ${c.used ? "USED" : "UNUSED"}</div>`).join("");
}
loadCodes();

document.getElementById('new').onclick = async () => {
  const code = crypto.randomUUID().slice(0,8).toUpperCase();
  await generateCode(code);
  loadCodes();
};
</script>
